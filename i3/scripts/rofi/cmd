#!/usr/bin/env bash

ROFI="rofi -dmenu -i -p"

# -----------------------------
# BASE COMMAND SELECTION
# -----------------------------
BASE_CMD=$(printf "%s\n" \
  "brightnessctl" \
  "redshift" \
  "volume (pactl)" \
  "custom command" \
  | $ROFI "Command")

[ -z "$BASE_CMD" ] && exit 0

# =============================
# BRIGHTNESSCTL
# =============================
if [[ "$BASE_CMD" == "brightnessctl" ]]; then
    ACTION=$(printf "%s\n" \
      "s → set brightness (MAIN)" \
      "s +10% → increase 10%" \
      "s 10%- → decrease 10%" \
      "i → info" \
      "list → list devices" \
      | $ROFI "brightnessctl")

    case "$ACTION" in
        "s → set brightness (MAIN)")
            VALUE=$(echo "" | $ROFI "Set brightness (1–100%)")
            [[ -n "$VALUE" ]] && brightnessctl s "${VALUE}%"
            ;;

        "s +10% → increase 10%")
            brightnessctl s +10%
            ;;

        "s 10%- → decrease 10%")
            brightnessctl s 10%-
            ;;

        "i → info")
            brightnessctl i | rofi -e "$(brightnessctl i)"
            ;;

        "list → list devices")
            brightnessctl --list | rofi -e "$(brightnessctl --list)"
            ;;
    esac
fi

# =============================
# REDSHIFT
# =============================
if [[ "$BASE_CMD" == "redshift" ]]; then
    ACTION=$(printf "%s\n" \
      "on → 4500K" \
      "off → reset" \
      "set temperature" \
      | $ROFI "redshift")

    case "$ACTION" in
        "on → 4500K")
            redshift -O 4500
            ;;

        "off → reset")
            redshift -x
            ;;

        "set temperature")
            TEMP=$(echo "" | $ROFI "Temperature (1000–6500)")
            [[ -n "$TEMP" ]] && redshift -O "$TEMP"
            ;;
    esac
fi

# =============================
# VOLUME (PACTL)
# =============================
if [[ "$BASE_CMD" == "volume (pactl)" ]]; then
    ACTION=$(printf "%s\n" \
      "up +5%" \
      "down -5%" \
      "mute toggle" \
      "set exact %" \
      | $ROFI "volume")

    case "$ACTION" in
        "up +5%")
            pactl set-sink-volume @DEFAULT_SINK@ +5%
            ;;

        "down -5%")
            pactl set-sink-volume @DEFAULT_SINK@ -5%
            ;;

        "mute toggle")
            pactl set-sink-mute @DEFAULT_SINK@ toggle
            ;;

        "set exact %")
            VOL=$(echo "" | $ROFI "Volume %")
            [[ -n "$VOL" ]] && pactl set-sink-volume @DEFAULT_SINK@ "${VOL}%"
            ;;
    esac
fi

# =============================
# CUSTOM COMMAND
# =============================
if [[ "$BASE_CMD" == "custom command" ]]; then
    CMD=$(echo "" | $ROFI "Run command")
    [[ -n "$CMD" ]] && bash -c "$CMD"
fi
