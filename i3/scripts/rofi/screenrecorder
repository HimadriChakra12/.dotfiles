#!/bin/bash
# Simple Rofi menu for screen recording

RECORD_SCRIPT="${SCREENRECORD_SCRIPT:-$HOME/.config/i3/scripts/screenrecord/screenrecord}"

# Check if recording is active
is_recording() {
  local pid_file="/tmp/screenrecord_pid_${USER}"
  [[ -f "$pid_file" ]] && kill -0 $(cat "$pid_file" 2>/dev/null) 2>/dev/null
}

if is_recording; then
  # Show stop option
  choice=$(echo "â¹ Stop Recording" | rofi -dmenu -i -p "Recording" -theme-str 'window {width: 300px;}')
  
  [[ "$choice" == "â¹ Stop Recording" ]] && "$RECORD_SCRIPT"
else
  # Show start options
  choice=$(printf "%s\n" \
    "ğŸ¬ Record" \
    "ğŸ¬ğŸ¤ Record + Audio" | \
    rofi -dmenu -i -p "Screen Record" -theme-str 'window {width: 300px;}')
  
  case "$choice" in
    "ğŸ¬ Record")
      "$RECORD_SCRIPT"
      ;;
    "ğŸ¬ğŸ¤ Record + Audio")
      "$RECORD_SCRIPT" --with-audio
      ;;
  esac
fi
