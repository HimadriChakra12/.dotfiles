#!/usr/bin/env bash

# -------- CONFIG --------
source "$HOME/.winegame/env.sh"

games=(
  "The Punisher:$HOME/Games/The Punisher/pun.exe"
  "Need For Speed:$HOME/Games/Need for Speed - Most Wanted/speed.exe"
  "Blur:$HOME/Games/Blur_Win_EN_Full-Rip/BLUR/Blur.exe"
  "Darkest Of Days:$HOME/Games/Darkest of Days/darkestofdays.exe"
  "Aliens VS Predator 2:$HOME/Games/Aliens versus Predator 2/AVP2.exe"
  "Spider Man:$HOME/Games/Spider-Man Web of Shadows/image/pc/Spider-Man Web of Shadows.exe"
)

WINE_CMD="$HOME/.winegame/run-game"
ROFI_CMD="rofi -dmenu -i -p 'Games'"

# -------- SCRIPT --------

# Extract only names for rofi
choice=$(printf "%s\n" "${games[@]}" | cut -d: -f1 | $ROFI_CMD)

# Exit if nothing selected
[[ -z "$choice" ]] && exit 0

# Find matching entry and launch
for entry in "${games[@]}"; do
  name="${entry%%:*}"
  path="${entry#*:}"

  if [[ "$name" == "$choice" ]]; then
    game_dir="$(dirname "$path")"
    game_exe="$(basename "$path")"

    cd "$game_dir" || exit 1
    exec $WINE_CMD "$game_exe"
  fi
done
